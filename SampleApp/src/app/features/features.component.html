<div class="features-container">
  <mat-toolbar color="primary">
    <div class="event-monitor-toolbar">
      <div class="event-item-toolbar">
        <span class="event-label-toolbar">Load:</span>
        <span class="event-count-toolbar">{{eventCounts.documentLoad}}</span>
      </div>
      <div class="event-item-toolbar">
        <span class="event-label-toolbar">Page:</span>
        <span class="event-count-toolbar">{{eventCounts.pageChange}}</span>
      </div>
      <div class="event-item-toolbar">
        <span class="event-label-toolbar">Scale:</span>
        <span class="event-count-toolbar">{{eventCounts.scaleChange}}</span>
      </div>
      <div class="event-item-toolbar">
        <span class="event-label-toolbar">Rotate:</span>
        <span class="event-count-toolbar">{{eventCounts.rotationChange}}</span>
      </div>
      <div class="event-item-toolbar">
        <span class="event-label-toolbar">Print:</span>
        <span class="event-count-toolbar">{{eventCounts.beforePrint}}</span>
      </div>
      <div class="event-item-toolbar">
        <span class="event-label-toolbar">Page {{currentPage}} | Scale {{currentScale}} | Rot {{currentRotation}}Â°</span>
      </div>
    </div>
    <span class="spacer"></span>
    <button mat-icon-button (click)="resetEventCounts()" matTooltip="Reset Event Counts">
      <mat-icon>refresh</mat-icon>
    </button>
  </mat-toolbar>

  <div class="content">
    <!-- Control Panel -->
    <mat-card class="control-panel">
      <mat-card-header>
        <mat-card-title>Control Panel</mat-card-title>
      </mat-card-header>
      
      <mat-card-content>
        <mat-tab-group>
          <!-- Control Visibility Tab -->
          <mat-tab label="Control Visibility">
            <div class="tab-content">
              <mat-form-field appearance="outline" class="full-width">
                <mat-label>Download File Name</mat-label>
                <input matInput [(ngModel)]="downloadFileName" placeholder="Enter custom file name">
              </mat-form-field>

              <div class="toggle-group show-hide-controls">
                <h4>Show/Hide Controls</h4>
                <mat-slide-toggle [(ngModel)]="openFile" color="primary">
                  Open File Button
                </mat-slide-toggle>
                <mat-slide-toggle [(ngModel)]="download" color="primary">
                  Download Button
                </mat-slide-toggle>
                <mat-slide-toggle [(ngModel)]="print" color="primary">
                  Print Button
                </mat-slide-toggle>
                <mat-slide-toggle [(ngModel)]="fullScreen" color="primary">
                  Full Screen Button
                </mat-slide-toggle>
                <mat-slide-toggle [(ngModel)]="find" color="primary">
                  Find Button
                </mat-slide-toggle>
                <mat-slide-toggle [(ngModel)]="viewBookmark" color="primary">
                  View Bookmark Button
                </mat-slide-toggle>
                <mat-slide-toggle [(ngModel)]="annotations" color="primary">
                  Annotations/Editor Controls
                </mat-slide-toggle>
              </div>

              <div class="toggle-group auto-actions">
                <h4>Auto Actions (trigger on document load)</h4>
                <mat-slide-toggle [(ngModel)]="startDownload" color="primary">
                  Auto Download
                </mat-slide-toggle>
                <mat-slide-toggle [(ngModel)]="startPrint" color="primary">
                  Auto Print
                </mat-slide-toggle>
                <mat-slide-toggle [(ngModel)]="lastPage" color="primary">
                  Go to Last Page
                </mat-slide-toggle>
              </div>

              <div class="button-group rotation-controls">
                <h4>Rotation Controls</h4>
                <button mat-raised-button color="primary" (click)="rotateClockwise()" matTooltip="Rotate Clockwise">
                  <mat-icon>rotate_right</mat-icon>
                  Rotate Clockwise
                </button>
                <button mat-raised-button color="primary" (click)="rotateCounterClockwise()" matTooltip="Rotate Counter-clockwise">
                  <mat-icon>rotate_left</mat-icon>
                  Rotate Counter-clockwise
                </button>
              </div>

              <div class="button-group on-demand-actions">
                <h4>On-Demand Actions</h4>
                <button mat-raised-button color="accent" (click)="triggerDownloadAction()" matTooltip="Trigger Download">
                  <mat-icon>download</mat-icon>
                  Download
                </button>
                <button mat-raised-button color="accent" (click)="triggerPrintAction()" matTooltip="Trigger Print">
                  <mat-icon>print</mat-icon>
                  Print
                </button>
                <button mat-raised-button color="accent" (click)="goToPageAction(1)" matTooltip="Go to Page 1">
                  <mat-icon>first_page</mat-icon>
                  Page 1
                </button>
                <button mat-raised-button color="accent" (click)="setZoomAction('page-fit')" matTooltip="Fit to Page">
                  <mat-icon>zoom_in</mat-icon>
                  Fit Page
                </button>
              </div>

              <div class="action-queue-status" *ngIf="getActionQueueStatus()">
                <h4>Action Queue Status</h4>
                <div class="status-item">
                  <span>Auto Actions:</span>
                  <span>{{getActionQueueStatus()?.autoActions || 0}}</span>
                </div>
                <div class="status-item">
                  <span>Pending Actions:</span>
                  <span>{{getActionQueueStatus()?.pendingActions || 0}}</span>
                </div>
                <div class="status-item">
                  <span>Executed Actions:</span>
                  <span>{{getActionQueueStatus()?.executedActions || 0}}</span>
                </div>
              </div>
            </div>
          </mat-tab>

          <!-- Modes Tab -->
          <mat-tab label="Modes">
            <div class="tab-content">
              <mat-form-field appearance="outline" class="full-width">
                <mat-label>Cursor Mode</mat-label>
                <mat-select [(ngModel)]="cursor">
                  <mat-option value="select">Select</mat-option>
                  <mat-option value="hand">Hand</mat-option>
                  <mat-option value="zoom">Zoom</mat-option>
                </mat-select>
              </mat-form-field>

              <mat-form-field appearance="outline" class="full-width">
                <mat-label>Scroll Mode</mat-label>
                <mat-select [(ngModel)]="scroll">
                  <mat-option value="vertical">Vertical</mat-option>
                  <mat-option value="horizontal">Horizontal</mat-option>
                  <mat-option value="wrapped">Wrapped</mat-option>
                </mat-select>
              </mat-form-field>

              <mat-form-field appearance="outline" class="full-width">
                <mat-label>Spread Mode</mat-label>
                <mat-select [(ngModel)]="spread">
                  <mat-option value="none">None</mat-option>
                  <mat-option value="odd">Odd</mat-option>
                  <mat-option value="even">Even</mat-option>
                </mat-select>
              </mat-form-field>

              <mat-form-field appearance="outline" class="full-width">
                <mat-label>Zoom</mat-label>
                <mat-select [(ngModel)]="zoom">
                  <mat-option value="auto">Auto</mat-option>
                  <mat-option value="page-actual">Page Actual</mat-option>
                  <mat-option value="page-fit">Page Fit</mat-option>
                  <mat-option value="page-width">Page Width</mat-option>
                  <mat-option value="0.5">50%</mat-option>
                  <mat-option value="0.75">75%</mat-option>
                  <mat-option value="1">100%</mat-option>
                  <mat-option value="1.25">125%</mat-option>
                  <mat-option value="1.5">150%</mat-option>
                  <mat-option value="2">200%</mat-option>
                </mat-select>
              </mat-form-field>

              <mat-form-field appearance="outline" class="full-width">
                <mat-label>Locale</mat-label>
                <mat-select [(ngModel)]="locale">
                  <mat-option value="en-US">English (US)</mat-option>
                  <mat-option value="de-AT">German (Austria)</mat-option>
                  <mat-option value="fr-FR">French (France)</mat-option>
                  <mat-option value="es-ES">Spanish (Spain)</mat-option>
                  <mat-option value="it-IT">Italian (Italy)</mat-option>
                </mat-select>
              </mat-form-field>

              <mat-form-field appearance="outline" class="full-width">
                <mat-label>Named Destination</mat-label>
                <input matInput [(ngModel)]="nameddest" placeholder="Enter named destination (e.g., 5.1)">
              </mat-form-field>

              <mat-form-field appearance="outline" class="full-width">
                <mat-label>Page Mode (Sidebar)</mat-label>
                <mat-select [(ngModel)]="pagemode">
                  <mat-option value="none">None</mat-option>
                  <mat-option value="thumbs">Thumbnails</mat-option>
                  <mat-option value="bookmarks">Bookmarks</mat-option>
                  <mat-option value="attachments">Attachments</mat-option>
                </mat-select>
              </mat-form-field>

              <mat-slide-toggle [(ngModel)]="useOnlyCssZoom" color="primary">
                Use Only CSS Zoom (Mobile)
              </mat-slide-toggle>
            </div>
          </mat-tab>

          <!-- Actions & Error Handling Tab -->
          <mat-tab label="Actions & Error Handling">
            <div class="tab-content">
              <div class="section-header">Actions</div>
              <div class="button-group">
                <button mat-raised-button color="primary" (click)="refreshViewer()">
                  Refresh Viewer
                </button>
                <button mat-raised-button color="accent" (click)="goToPage(1)">
                  Go to Page 1
                </button>
                <button mat-raised-button color="accent" (click)="goToPage(3)">
                  Go to Page 3
                </button>
                <button mat-raised-button color="accent" (click)="goToPage(5)">
                  Go to Page 5
                </button>
              </div>

              <div class="toggle-group error-handling">
                <h4>Error Handling</h4>
                
                <mat-slide-toggle [(ngModel)]="diagnosticLogs" color="primary">
                  Enable Diagnostic Logs
                </mat-slide-toggle>
                <mat-form-field appearance="outline" class="full-width">
                  <mat-label>Custom Error Message</mat-label>
                  <textarea matInput [(ngModel)]="errorMessage" rows="3" placeholder="Enter custom error message"></textarea>
                </mat-form-field>

                <mat-slide-toggle [(ngModel)]="errorOverride" color="primary">
                  Override Default Error
                </mat-slide-toggle>
                <mat-slide-toggle [(ngModel)]="errorAppend" color="primary">
                  Append to Default Error
                </mat-slide-toggle>

                <div class="button-group">
                  <button mat-raised-button color="warn" (click)="testError()">
                    Test Error Handling
                  </button>
                  <button mat-raised-button color="primary" (click)="restoreValidPdf()">
                    Restore Valid PDF
                  </button>
                </div>
              </div>
            </div>
          </mat-tab>
        </mat-tab-group>
      </mat-card-content>
    </mat-card>



    <!-- PDF Viewer -->
    <mat-card class="pdf-viewer-card">
      <mat-card-header>
        <mat-card-title>PDF Viewer</mat-card-title>
      </mat-card-header>
      
      <mat-card-content>
        <div class="pdf-container">
          <ng2-pdfjs-viewer 
            #testPdfViewer 
            pdfSrc="/assets/pdfjs/web/compressed.tracemonkey-pldi-09.pdf"
            [viewerId]="'test-viewer'"
            [downloadFileName]="downloadFileName"
            [openFile]="openFile"
            [download]="download"
            [print]="print"
            [fullScreen]="fullScreen"
            [find]="find"
            [viewBookmark]="viewBookmark"
            [annotations]="annotations"
            [startDownload]="startDownload"
            [startPrint]="startPrint"
            [lastPage]="lastPage"
            [cursor]="cursor"
            [scroll]="scroll"
            [spread]="spread"
            [zoom]="zoom"
            [nameddest]="nameddest"
            [pagemode]="pagemode"
            [locale]="locale"
            [useOnlyCssZoom]="useOnlyCssZoom"
            [errorOverride]="errorOverride"
            [errorAppend]="errorAppend"
            [errorMessage]="errorMessage"
            [diagnosticLogs]="diagnosticLogs"
            (onDocumentLoad)="onDocumentLoad()"
            (onPageChange)="onPageChange($event)"
            (onScaleChange)="onScaleChange($event)"
            (onRotationChange)="onRotationChange($event)"
            (onBeforePrint)="onBeforePrint()"
            (onAfterPrint)="onAfterPrint()">
          </ng2-pdfjs-viewer>
        </div>
      </mat-card-content>
    </mat-card>
  </div>
</div> 