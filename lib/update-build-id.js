const fs = require("fs");
const path = require("path");

// Get current timestamp in Eastern Time (NYC)
const now = new Date();
const easternTimeString = now.toLocaleString("en-US", {
  timeZone: "America/New_York",
  year: "numeric",
  month: "2-digit",
  day: "2-digit",
  hour: "2-digit",
  minute: "2-digit",
  second: "2-digit",
  hour12: false,
});

// Convert to Eastern Time timestamp format: YYYY-MM-DDTHH-MM-SS-000Z
const timestamp = easternTimeString
  .replace(/(\d+)\/(\d+)\/(\d+),\s*(\d+):(\d+):(\d+)/, "$3-$1-$2T$4-$5-$6-000Z")
  .replace(/[:.]/g, "-");

console.log(`ðŸ”„ Updating BUILD_ID to: ${timestamp}`);

// Create/update the separate build info file (not tracked in git)
const buildInfoPath = path.join(__dirname, "build-info.js");
const buildInfoContent = `// Build information - This file is auto-generated and should not be tracked in git
// Generated by update-build-id.js during the build process

window.NG2_PDF_VIEWER_BUILD_ID = '${timestamp}';`;

fs.writeFileSync(buildInfoPath, buildInfoContent, "utf8");
console.log(`âœ… Updated build-info.js with BUILD_ID: ${timestamp}`);

console.log("ðŸŽ‰ BUILD_ID update complete!");
